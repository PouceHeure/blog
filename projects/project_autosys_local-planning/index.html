<!doctype html><html lang=en><head><meta charset=UTF-8><meta name=viewport content="width=device-width,initial-scale=1"><title>Hugo POUSSEUR</title><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/bootstrap-icons/font/bootstrap-icons.css><link rel=stylesheet href=https://pouceheure.github.io/blog/css/style.css><link rel=stylesheet href=https://pouceheure.github.io/blog/css/color.css><link rel=stylesheet href=https://pouceheure.github.io/blog/css/markdown.css><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/katex@0.16.4/dist/katex.min.css><link rel=icon type=image/png sizes=32x32 href=https://pouceheure.github.io/blog/favicon//favicon-32.png><link rel=icon type=image/png sizes=16x16 href=https://pouceheure.github.io/blog/favicon//favicon-16.png><link rel=icon type=image/png sizes=64x64 href=https://pouceheure.github.io/blog/favicon//favicon-64.png><link rel=apple-touch-icon sizes=180x180 href=https://pouceheure.github.io/blog/favicon//apple-touch-icon.png><link rel="shortcut icon" href=https://pouceheure.github.io/blog/favicon//favicon.ico><style>@media(max-width:767.98px){main{margin-top:112px}}@media(min-width:768px){main{margin-top:56px}}</style></head><body class=bg-light><header><nav class="navbar navbar-expand-md navbar-dark navbar-custom fixed-top bg-primary text-white p-2"><div class="container-fluid px-4 d-flex align-items-center justify-content-between"><a class="navbar-brand fw-bold" href=https://pouceheure.github.io/blog/>Hugo POUSSEUR</a><div class="d-flex align-items-center social-icons ms-md-0 ms-auto"><a href=https://www.linkedin.com/in/hugo-pousseur/ target=_blank class="text-white me-2"><i class="bi bi-linkedin icon-size"></i>
</a><a href=https://github.com/pouceheure/ target=_blank class="text-white me-2"><i class="bi bi-github icon-size"></i>
</a><button type=button class="btn btn-link text-white me-2 p-0" data-bs-toggle=modal data-bs-target=#contactModal>
<i class="bi bi-chat-fill icon-size"></i>
</button>
<a href="https://www.youtube.com/playlist?list=PLGzYzDkg-SZrXPj-0gGwnueRWiMS9GiOM" target=_blank class=text-white><i class="bi bi-youtube icon-size-lg"></i></a></div><div class="collapse navbar-collapse justify-content-end d-none d-md-flex" id=navbarNav><ul class=navbar-nav><li class=nav-item><a class="nav-link text-white fw-bold me-3" href=https://pouceheure.github.io/blog/>Home</a></li><li class=nav-item><a class="nav-link text-white fw-bold me-3" href=https://pouceheure.github.io/blog/projects/>Projects</a></li><li class=nav-item><a class="nav-link text-white fw-bold me-3" href=https://pouceheure.github.io/blog/articles/><span class="d-none d-lg-inline">Scientific </span>Articles</a></li><li class=nav-item><a class="nav-link text-white fw-bold me-3" href=https://pouceheure.github.io/blog/cv/>About</a></li></ul></div></div></nav><nav class="d-flex d-md-none bg-secondary p-2 navbar-dark navbar-custom fixed-top" style=top:56px;z-index:10><div class="container-fluid d-flex justify-content-around"><ul class="navbar-nav flex-row w-100 justify-content-around mb-0"><li class=nav-item><a class="nav-link text-white fw-bold" href=https://pouceheure.github.io/blog/>Home</a></li><li class=nav-item><a class="nav-link text-white fw-bold" href=https://pouceheure.github.io/blog/projects/>Projects</a></li><li class=nav-item><a class="nav-link text-white fw-bold" href=https://pouceheure.github.io/blog/articles/>Articles</a></li><li class=nav-item><a class="nav-link text-white fw-bold" href=https://pouceheure.github.io/blog/cv/>About</a></li></ul></div></nav></header><main class=container><meta name=description content="Local planning applied to real autonomous vehicles, combining global route planning, local path adjustment, and dynamic control profile."><meta name=keywords content="autonomous_vehicle,planning_navigation,robotics_autonomy,ros2"><meta name=author content="Hugo POUSSEUR"><meta property="og:title" content="Autonomous Vehicle: Planning"><meta property="og:description" content="Local planning applied to real autonomous vehicles, combining global route planning, local path adjustment, and dynamic control profile."><meta property="og:type" content="article"><meta property="og:url" content="https://pouceheure.github.io/blog/projects/project_autosys_local-planning/"><meta property="og:image" content="https://pouceheure.github.io/blog/images/local-planning/rviz_planning.png"><link rel=stylesheet href=https://pouceheure.github.io/blog/css/toc.css><link rel=stylesheet href=https://pouceheure.github.io/blog/css/markdown-index.css><div class="container d-flex flex-column flex-md-row align-items-start min-vh-100 gap-4"><aside class="toc w-30 d-none d-lg-block toc-sticky"><div class="toc-container p-3 shadow rounded card d-flex flex-column h-100 card-transparent"><h5 class=toc-title><i class="bi bi-journal-richtext me-1"></i> Contents</h5><nav id=TableOfContents><ul><li><a href=#demonstration>Demonstration</a></li><li><a href=#overview>Overview</a></li><li><a href=#navigation-stack-architecture>Navigation Stack Architecture</a></li><li><a href=#global-route-planning>Global Route Planning</a><ul><li><a href=#responsibilities>Responsibilities</a></li></ul></li><li><a href=#integrated-planning-stack>Integrated Planning Stack</a></li><li><a href=#path-planning>Path Planning</a><ul><li><a href=#problem>Problem</a></li><li><a href=#local-path-planner>Local Path Planner</a></li><li><a href=#interpolation>Interpolation</a></li></ul></li><li><a href=#motion-profile-generation>Motion Profile Generation</a><ul><li><a href=#speed-profile-signal>Speed Profile: Signal</a></li><li><a href=#speed-profile-road-element-handler>Speed Profile: Road Element Handler</a><ul><li><a href=#example-stop>Example: STOP</a></li><li><a href=#state-transitions>State Transitions</a></li></ul></li><li><a href=#speed-profile-combined-signals>Speed Profile: Combined Signals</a></li><li><a href=#speed-profile-curvatures>Speed Profile: Curvatures</a></li><li><a href=#speed-profile-demonstration>Speed Profile: Demonstration</a></li></ul></li><li><a href=#references>References</a></li></ul></nav></div></aside><article class="markdown-content flex-grow-1 w-100 w-md-75 card-transparent p-0 p-md-3"><h1 class=text-primary>Autonomous Vehicle: Planning</h1><div class="d-flex flex-wrap gap-2"><a href=https://pouceheure.github.io/blog/tags/autonomous_vehicle/ class="btn btn-sm btn-secondary"><i class="bi bi-tag"></i>
<strong style=font-size:1em>Autonomous Vehicle</strong>
</a><a href=https://pouceheure.github.io/blog/tags/planning_navigation/ class="btn btn-sm btn-secondary"><i class="bi bi-tag"></i>
<strong style=font-size:1em>Planning & Navigation</strong>
</a><a href=https://pouceheure.github.io/blog/tags/robotics_autonomy/ class="btn btn-sm btn-secondary"><i class="bi bi-tag"></i>
<strong style=font-size:1em>Robotics & Autonomy</strong>
</a><a href=https://pouceheure.github.io/blog/tags/ros2/ class="btn btn-sm btn-secondary"><i class="bi bi-tag"></i>
<strong style=font-size:1em>ROS2</strong>
</a><span class="btn btn-sm btn-info text-white" style=pointer-events:none><i class="bi bi-code-slash"></i>
<strong style=font-size:1em>cpp</strong></span></div><div class=content><h2 id=demonstration>Demonstration</h2><figure><div class="ratio ratio-16x9" style=max-width:800px;margin:auto><iframe src=https://www.youtube.com/embed/wnQpdtmPgv0 allowfullscreen></iframe></div><figcaption>Video 1 - Demo video, slalom test.</figcaption></figure><figure><div class="ratio ratio-16x9" style=max-width:800px;margin:auto><iframe src=https://www.youtube.com/embed/As44QMtXXiw allowfullscreen></iframe></div><figcaption>Video 2 - Demo video, curve test.</figcaption></figure><h2 id=overview>Overview</h2><p>As part of a collaborative autonomous driving project, I contributed to the implementation of the core planning functionalities for autonomous driving.<br>The navigation stack transforms a target position into a safe and efficient motion trajectory using environmental context and map information.</p><p>The process is divided into three stages:</p><ul><li><strong>Global route computation</strong>: finding a feasible route on the road network</li><li><strong>Local path generation</strong>: adjusting the trajectory to avoid obstacles</li><li><strong>Motion profile optimization</strong>: generating smooth and feasible velocities along the path</li></ul><figure id=fig-1><img src=https://pouceheure.github.io/blog/images/local-planning/global-goal.png alt width=600><figcaption>Fig. 1 - Navigation stack I/O.</figcaption></figure><h2 id=navigation-stack-architecture>Navigation Stack Architecture</h2><p>The architecture follows a modular structure in ROS2. Each node is responsible for a specific step in the planning pipeline:</p><ul><li><strong>Route Server</strong>: computes the topological path</li><li><strong>Path Planner + Path Adapter</strong>: modifies the route to avoid obstacles</li><li><strong>Motion Manager</strong>: assigns a feasible velocity profile</li><li><strong>Controller</strong>: executes the commands</li></ul><figure id=fig-2><img src=https://pouceheure.github.io/blog/images/local-planning/nodes.png alt width=700><figcaption>Fig. 2 - Nodes and relations of the stack, including data exchange details.</figcaption></figure><h2 id=global-route-planning>Global Route Planning</h2><h3 id=responsibilities>Responsibilities</h3><p>The Route Server node computes the route from the current vehicle position $A$ to the goal $B$, using algorithms such as Dijkstra or A*. The process includes:</p><ul><li>Matching the vehicle&rsquo;s current position on the HD map</li><li>Matching the target goal</li><li>Planning the shortest or safest path $\mathcal{P}(A, B)$</li><li>Providing a ROS2 service to compute routes for a queue of goals ${B_1, B_2, \dots}$</li></ul><figure id=fig-3><img src=https://pouceheure.github.io/blog/images/local-planning/route_rviz.png alt width=500><figcaption>Fig. 3 - Route computed on topological map displayed in RViz</figcaption></figure><h2 id=integrated-planning-stack>Integrated Planning Stack</h2><p>Closed-loop autonomous operation is achieved by chaining:</p><ol><li>Target reception → global route</li><li>Obstacle analysis → adjusted path</li><li>Velocity assignment → dynamic feasibility</li><li>ROS2 interface → command execution</li></ol><figure id=fig-4><img src=https://pouceheure.github.io/blog/images/local-planning/global-view.png alt width=750><figcaption>Fig. 4 - High-level planning loop integrating route, path, and motion generation</figcaption></figure><h2 id=path-planning>Path Planning</h2><h3 id=problem>Problem</h3><p>Even when a global route exists, dynamic obstacles may obstruct the reference trajectory. A local path must be adapted in real time to maintain safety.</p><figure id=fig-5><img src=https://pouceheure.github.io/blog/images/local-planning/path-idea.png alt width=600><figcaption>Fig. 5 - Path replanning principle: local obstacle avoidance while following global route</figcaption></figure><h3 id=local-path-planner>Local Path Planner</h3><p>This module scans the global path to determine whether obstacles intersect it. When an obstacle is detected, the system computes:</p><ul><li>The <strong>longitudinal distance</strong> $s$ at which the obstacle interferes</li><li>The <strong>required lateral shift</strong> $q(s)$ needed to avoid the obstacle</li></ul><p>The planner then outputs a new trajectory by adjusting the centerline accordingly.</p><figure id=fig-6><img src=https://pouceheure.github.io/blog/images/local-planning/path.png alt width=700><figcaption>Fig. 6 - Local path shift to avoid obstacle, expressed as lateral displacement along the Frenet frame</figcaption></figure><p>The design is based on research from
<span class=citation><a href=#ref-LocalASaid>LocalSaid 2023</a>
</span>. The animation below illustrates a Python-based simulation used to evaluate the solution and guide the design of an architecture suitable for integration into the navigation stack. The method from the original reference has been adapted to meet specific system requirements.</p><figure id=fig-7><img src=https://pouceheure.github.io/blog/images/local-planning/simu.gif alt width=800><figcaption>Fig. 7 - Python simulation of the planning loop, based on the referenced method.</figcaption></figure><h3 id=interpolation>Interpolation</h3><p>To define a smooth trajectory in the plane, the path is represented using <strong>curvilinear interpolation</strong>, where $x(d)$ and $y(d)$ are interpolated independently as functions of the <strong>arc length parameter</strong> $d$.</p><p>Cubic splines are commonly used for this purpose, ensuring continuity of position, first derivative (tangent), and second derivative (curvature). The path is thus defined by:</p><blockquote><div class=equation-scroll-wrapper><div class=equation-block>$$
\gamma(d) = \begin{pmatrix} x(d) \\ y(d) \end{pmatrix}
\quad \text{Eq (1)} $$</div></div></blockquote><p>Where:</p><ul><li>$d$: curvilinear abscissa (arc length) along the path</li><li>$x(d)$, $y(d)$: smooth spline interpolations based on reference waypoints</li></ul><p>This approach enables the evaluation of geometric quantities such as direction and curvature at any point along the trajectory.</p><h2 id=motion-profile-generation>Motion Profile Generation</h2><p>The speed profile of a vehicle depends on various factors, including:</p><ul><li>Road elements (e.g., stop signs, traffic lights, speed bumps)</li><li>Obstacles on the road (e.g., vehicles, pedestrians)</li></ul><h3 id=speed-profile-signal>Speed Profile: Signal</h3><p>To combine these different inputs, a <strong>speed signal profile</strong> is used. This is represented as a step signal indicating the <strong>maximum allowed speed</strong> at each point along the trajectory (x-axis: distance, y-axis: maximum speed).</p><p>This representation is efficient because only the key change points are defined, with the speed assumed constant between two points.</p><figure id=fig-8><img src=https://pouceheure.github.io/blog/images/local-planning/signal-example.png alt width=300><figcaption>Fig. 8 - Signal Example</figcaption></figure><p>Example:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>distance <span style=color:#f92672>[</span>m<span style=color:#f92672>]</span>:    72.0  | 75.0
</span></span><span style=display:flex><span>speed <span style=color:#f92672>[</span>m/s<span style=color:#f92672>]</span> :     5.0  |  0.0
</span></span></code></pre></div><p>This specifies a speed of 5.0 m/s until 75.0 meters, where it drops to 0.0 m/s.</p><h3 id=speed-profile-road-element-handler>Speed Profile: Road Element Handler</h3><p>Each <strong>road element</strong> is associated with a <strong>handler</strong>.<br>The purpose of the handler is to define the <strong>Finite State Machine (FSM)</strong> of that element.<br>Each <strong>state</strong> of the element specifies a corresponding <strong>speed signal</strong>.</p><h4 id=example-stop>Example: STOP</h4><p>A <strong>STOP</strong> road element, exploits the handler <strong>HandlerLockWait</strong></p><p>A <strong>HandlerLockWait</strong> element defines three states:</p><table><thead><tr><th><strong>State</strong></th><th><strong>Description</strong></th><th><strong>Signal</strong></th></tr></thead><tbody><tr><td><strong>LOCK</strong></td><td>The stop is active.<br>The signal remains <strong>UP</strong> until the vehicle reaches the stop, then becomes <strong>0</strong>.</td><td><code>UP → 0</code></td></tr><tr><td><strong>WAIT</strong></td><td>The vehicle has reached the stop and is waiting for permission to start.</td><td><code>0</code></td></tr><tr><td><strong>FREE</strong></td><td>The vehicle has passed the stop.</td><td><code>UP</code></td></tr></tbody></table><h4 id=state-transitions>State Transitions</h4><h5 id=automatic-transitions>Automatic Transitions</h5><p>Some transitions occur <strong>automatically</strong>. In these case the state machine can apply the transition himself, without autorisation.</p><blockquote><p>For example: <code>LOCK → WAIT</code> This happens once the vehicle reaches the stop position and its speed equals <strong>0</strong>. The vehicle performs this transition autonomously.</p></blockquote><h5 id=permission-based-transitions>Permission-Based Transitions</h5><p>Other transitions require <strong>explicit permission</strong>. In these case the state machine should wait a permission (a flag), to inform the transition is possible.</p><blockquote><p>For example: <code>WAIT → FREE</code> This transition requires authorization from the <strong>decision server</strong>, ensuring the <strong>decision layer</strong> has confirmed it is safe for the vehicle to proceed.</p></blockquote><h3 id=speed-profile-combined-signals>Speed Profile: Combined Signals</h3><p>Multiple signals can be combined by taking the <strong>minimum</strong> at each point, ensuring compliance with all constraints.</p><p>The example below shows two road elements: a speed bump and a stop sign.</p><ul><li>The <strong>speed bump</strong> requires slowing to approximately $ v \approx 1.8\ \text{m/s} $.</li><li>The <strong>stop sign</strong> requires a complete stop ($ v = 0\ \text{m/s} $).</li></ul><figure id=fig-9><img src=https://pouceheure.github.io/blog/images/local-planning/road-elements.png alt width=800><figcaption>Fig. 9 - Road elements matched to trajectory positions.</figcaption></figure><figure id=fig-10><img src=https://pouceheure.github.io/blog/images/local-planning/signals-combined-example.png alt width=800><figcaption>Fig. 10 - Combined speed signal based on road elements.</figcaption></figure><h3 id=speed-profile-curvatures>Speed Profile: Curvatures</h3><div class=refer-box><i class="bi bi-book"></i> For more details, refer to the <strong>Profile Fusion</strong> section of <a href=https://pouceheure.github.io/blog/projects/project_autosys_control/#profile-fusion>Control Project</a>.</div><h3 id=speed-profile-demonstration>Speed Profile: Demonstration</h3><figure><div class="ratio ratio-16x9" style=max-width:800px;margin:auto><iframe src=https://www.youtube.com/embed/QCiN3yqT5E8 allowfullscreen></iframe></div><figcaption>Video 3 - Autonomous vehicle control adapted to road elements.</figcaption></figure><h2 id=references>References</h2><ul><li id=ref-LocalASaid class=citation style=margin-bottom:1em><strong>Local trajectory planning for autonomous vehicle with static and dynamic obstacles avoidance</strong><br><span style=color:#555>Abdallah Said, Reine Talj, Clovis Francis, Hassan Shraim</span><br><em>IEEE ITSC 2021</em><br><a href=https://hal.science/hal-03456617/file/ITSC_1904.pdf target=_blank style=font-size:90%;color:#1e88e5>[Access PDF]</a></li></ul></div></article></div><script src=https://pouceheure.github.io/blog/js/highlight-toc.js></script><script src=https://pouceheure.github.io/blog/js/counter-toc.js></script><script src=https://pouceheure.github.io/blog/js/select-toc-part.js></script><script src=https://pouceheure.github.io/blog/js/select-video.js></script></main><div class="modal fade" id=contactModal tabindex=-1 aria-labelledby=contactModalLabel aria-hidden=true><div class="modal-dialog modal-dialog-centered"><div class=modal-content><div class=modal-header><h5 class=modal-title id=contactModalLabel>Contact me</h5><button type=button class=btn-close data-bs-dismiss=modal aria-label=Close></button></div><div class=modal-body><p class=mb-2>Send me email with subject starting by [contact-web]. Email address: click on reveal (avoid bot scrapping).</p><code id=email data-noise=~ data-email="=02~bj5~Cbp~FWb~nBk~c1V~2cz~V3b~w5y~bnV~Ha">=02~bj5~Cbp~FWb~nBk~c1V~2cz~V3b~w5y~bnV~Ha</code><div class=visually-hidden aria-live=polite id=emailLive></div></div><div class=modal-footer><button id=revealEmailBtn class="btn btn-primary">
Reveal Email
</button>
<button type=button class="btn btn-secondary" data-bs-dismiss=modal>
Close</button></div></div></div></div><script src=https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js></script><script defer src=https://cdn.jsdelivr.net/npm/katex@0.16.4/dist/katex.min.js></script><script defer src=https://cdn.jsdelivr.net/npm/katex@0.16.4/dist/contrib/auto-render.min.js onload=renderMathInElement(document.body)></script><script async src=https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js></script><script src=https://pouceheure.github.io/blog/js/setup-latex.js></script><script src=https://pouceheure.github.io/blog/js/highlight-navbar.js></script><script>highlightNavbar("https://pouceheure.github.io/blog/")</script><script src=https://pouceheure.github.io/blog/js/webmail-reveal.js></script></body></html>